<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ficha del trabajador</title>

<style>
 body {
    font-family: Arial;
    background: #0C2340; /* Pantone 289 C*/
    padding: 20px;
  }
.card {
  background:white;
  padding:20px;
  border-radius:10px;
  max-width:400px;
  margin:auto;
  box-shadow:0 0 10px rgba(0,0,0,0.2);
}
h2 {
  text-align:center;
}
.item {
  margin:10px 0;
}
.label {
  font-weight:bold;
}
</style>
</head>

<body>
<div style="text-align:center; margin-bottom:15px;">
  <img src="imagen confi.png" alt="Logo empresa" style="max-width:180px;">
</div>
<div class="card">
  <h2>PROGRAMA DE CALIFICACION DEL PERSONAL</h2>
<div class="item"><span class="label">Nombre:</span> <span id="nombre"></span></div>
<div class="item"><span class="label">Documento:</span> <span id="doc"></span></div>
<div class="item"><span class="label">Cargo:</span> <span id="cargo"></span></div>
    <h2>CAPACITACIONES VIGENTES:</h2>
<div class="item"><span class="label">Capacitación vigente:</span> <span id="cap"></span></div>
<div class="item"><span class="label">Fecha de realización:</span> <span id="fecha"></span></div>
</div>
<div class="item"><span class="label">Capacitaciones realizadas:</span> <span id="totalCaps"></span></div>
<div class="item">
  <span class="label">Detalle:</span>
  <ul id="listaCaps" style="margin:8px 0 0 18px;"></ul>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

// ⚠️ Pega aquí TU URL real de Apps Script
const API = "https://script.google.com/macros/s/AKfycbyP0POtIMeWGFXSOdl000ADfZqlEWYJJJNILHN5tZbZXOoau_9_hOeYmXkVBYP4LkwA/exec";

fetch(API + "?id=" + id)
  .then(res => res.json())
  .then(data => {
    if (data.error) {
      alert(data.error);
      return;
    }
document.getElementById("nombre").textContent = data.Nombre;
document.getElementById("doc").textContent = data.Documento;
document.getElementById("cargo").textContent = data.Cargo;
document.getElementById("cap").textContent = data.Capacitacion;
const fecha = new Date(data.Fecha);
document.getElementById("fecha").textContent = 
  fecha.toLocaleDateString("es-CO");

  })
  .catch(err => {
    alert("Error conectando con la base de datos");
    console.error(err);
  });

 document.getElementById("totalCaps").textContent = data.TotalCapacitaciones ?? 0;

const ul = document.getElementById("listaCaps");
ul.innerHTML = "";

if (data.Capacitaciones && data.Capacitaciones.length) {
  data.Capacitaciones.forEach(c => {
    const li = document.createElement("li");

    // Formato fecha dd/mm/aaaa
    let fechaTxt = "";
    if (c.Fecha) {
      const d = new Date(c.Fecha);
      fechaTxt = isNaN(d.getTime())
        ? String(c.Fecha)
        : d.toLocaleDateString("es-CO");
    }

    li.textContent = fechaTxt ? `${c.Nombre} — ${fechaTxt}` : c.Nombre;
    ul.appendChild(li);
  });
} else {
  const li = document.createElement("li");
  li.textContent = "Sin capacitaciones registradas.";
  ul.appendChild(li);
}
if (capName && String(capName).trim() !== "") {

</script>

</body>
</html>
